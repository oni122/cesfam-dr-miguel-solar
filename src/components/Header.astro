---
import HeaderButton from "./HeaderButton.astro";

const menuSections = [
  { kind: "link", href: "/", label: "Inicio" },
  { kind: "link", href: "/noticia", label: "Noticias" },
  {
    kind: "dropdown",
    id: "institucion",
    label: "Institución",
    items: [
      { href: "/about", label: "Quiénes Somos" },
      { href: "/misionvision", label: "Misión y Visión" },
      { href: "/horario", label: "Horarios" },
    ],
  },
  {
    kind: "dropdown",
    id: "programas",
    label: "Programas",
    items: [
      { href: "/alimentacioncomp", label: "Alimentación Complementaria" },
      { href: "/Odontologia", label: "Odontológicos" },
      { href: "/rehabilitacion", label: "Rehabilitación" },
      { href: "/vidasana", label: "Vida Sana" },
    ],
  },
  {
    kind: "dropdown",
    id: "servicios",
    label: "Servicios",
    items: [
      { href: "/farmacia", label: "Farmacia" },
      { href: "/oirs", label: "OIRS" },
      { href: "/entregalya", label: "Entrega de leche y Alimentación" },
      { href: "/curacionytratamientos", label: "Curaciones y Tratamientos" },
      { href: "/tomamuestras", label: "Toma de Muestras" },
      { href: "/vacunatorio", label: "Vacunatorio" },
    ],
  },
  { kind: "link", href: "/atencion/opciones", label: "¿Necesitas atención?" },
  { kind: "link", href: "/informate", label: "OIRS" },
];

const ctaLinks = [
  { href: "/reserva/reserva", label: "Reserva tu Hora" },
  { href: "/login", label: "Iniciar sesión" },
];
---

<header class="w-full shadow-2xl overflow-hidden relative">
  <div class="w-full relative">
    <img src="/header2.png" alt="Foto del hospital" class="object-cover h-[11rem] w-full title" />
    <h4 class="absolute inset-0 flex items-center justify-center text-lg md:text-3xl font-bold text-white bg-black bg-opacity-40 px-2 text-center">
      CESFAM DR MIGUEL SOLAR DE PAINE
    </h4>
  </div>

  <div class="relative bg-[#200934] text-white">
    <div class="flex justify-between px-6 md:px-10 py-3">
      <a href="/" class="shrink-0">
        <img src="/logo.png" alt="Logo" class="h-12" />
      </a>

      <nav class="hidden md:flex flex-1 justify-start gap-6 font-semibold">
        {
          menuSections.map((section) =>
            section.kind === "link" ? (
              <HeaderButton href={section.href}>{section.label}</HeaderButton>
            ) : (
              <el-dropdown class="relative pt-1">
                <button class="inline-flex items-center gap-x-1.5 rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20 focus:outline-none">
                  {section.label}
                  <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="-mr-1 size-5 text-gray-400">
                    <path d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
                  </svg>
                </button>
                <el-menu
                  anchor="bottom start"
                  class="absolute mt-2 ml-1 w-56 origin-left rounded-md bg-gray-800 shadow-lg transition transition-discrete [--anchor-gap:--spacing(2)] data-closed:scale-95 data-closed:transform data-closed:opacity-0 data-enter:duration-100 data-enter:ease-out data-leave:duration-75 data-leave:ease-in z-50">
                  <div class="py-1">
                    {section.items?.map((item) => (
                      <a href={item.href} class="block px-4 py-2 text-sm text-gray-300 hover:bg-white/5 hover:text-white focus:bg-white/5 focus:text-white">
                        {item.label}
                      </a>
                    ))}
                  </div>
                </el-menu>
              </el-dropdown>
            )
          )
        }
      </nav>

      <nav class="hidden md:flex gap-3 font-semibold">
        {ctaLinks.map((link) => (
          <HeaderButton href={link.href}>{link.label}</HeaderButton>
        ))}
      </nav>

      <label for="mobile-toggle" class="md:hidden cursor-pointer p-2">
        <img src="/menu.png" alt="Abrir menú" class="h-7 w-7" />
      </label>
    </div>

    <input id="mobile-toggle" type="checkbox" class="peer hidden" />
    <div class="md:hidden bg-[#200934] max-h-0 overflow-hidden transition-all duration-300 peer-checked:max-h-[45rem]">
      <nav class="flex flex-col gap-2 px-4 pb-6 font-semibold">
        {
          menuSections.map((section) =>
            section.kind === "link" ? (
              <div class="border-b">
                <HeaderButton href={section.href}>{section.label}</HeaderButton>
              </div>
            ) : (
              <div class="border-b">
                <label for={`mobile-${section.id}-toggle`} class="block py-2 cursor-pointer">
                  {section.label}
                </label>
                <input id={`mobile-${section.id}-toggle`} type="checkbox" class="peer hidden" />
                <div class="flex flex-col pl-4 max-h-0 overflow-hidden transition-all duration-300 peer-checked:max-h-64">
                  {section.items?.map((item) => (
                    <a href={item.href} class="block py-2">{item.label}</a>
                  ))}
                </div>
              </div>
            )
          )
        }

        <div class="mt-4 border-t pt-4 flex flex-col gap-3">
          {ctaLinks.map((link) => (
            <HeaderButton href={link.href}>{link.label}</HeaderButton>
          ))}
        </div>
      </nav>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>
</header>
